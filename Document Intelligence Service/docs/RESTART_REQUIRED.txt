╔═══════════════════════════════════════════════════════════════════╗
║                  🔴 RESTART SERVICE NGAY!                         ║
╚═══════════════════════════════════════════════════════════════════╝

┌───────────────────────────────────────────────────────────────────┐
│ ✅ API KEY ĐÃ CÓ TRONG .ENV                                       │
└───────────────────────────────────────────────────────────────────┘

  GEMINI_API_KEY=AIzaSyB0h_O7rVZTcSqh1iPHvuRwEE5PsCgvK18

┌───────────────────────────────────────────────────────────────────┐
│ ⚠️ VẤN ĐỀ                                                        │
└───────────────────────────────────────────────────────────────────┘

  Service đang chạy CŨ → CHƯA load API key từ .env
  
  Bạn phải RESTART để Flask load_dotenv() chạy lại!

┌───────────────────────────────────────────────────────────────────┐
│ 🚀 GIẢI PHÁP (3 BƯỚC)                                             │
└───────────────────────────────────────────────────────────────────┘

  BƯỚC 1: STOP service cũ
  ========================
  
  Trong terminal đang chạy, nhấn: Ctrl + C
  
  
  BƯỚC 2: START service mới
  ==========================
  
  Chạy lệnh này:
  
    .\restart_service.bat
  
  Hoặc manual:
  
    .\DIS\Scripts\Activate.ps1
    $env:PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION='python'
    python app.py
  
  
  BƯỚC 3: KIỂM TRA
  =================
  
  Mở: http://127.0.0.1:5003
  
  Xem AI Enhancement:
    ❌ INACTIVE  → ✅ ACTIVE  (Màu xanh!)

┌───────────────────────────────────────────────────────────────────┐
│ 🎯 KẾT QUẢ SAU KHI RESTART                                       │
└───────────────────────────────────────────────────────────────────┘

  CONSOLE LOG:
  
    ║   🤖 AI: ✅ Enabled (gemini-2.0-flash-exp)
    ║   🌐 URL: http://0.0.0.0:5003
    
  WEB UI:
  
    ╔═══════════════════════════════════════════════╗
    ║ 🤖 AI Enhancement (Gemini 2.0 Flash)  ACTIVE ║
    ╠═══════════════════════════════════════════════╣
    ║ ✓ Phân loại document tự động                 ║
    ║ ✓ Trích xuất thông tin thông minh            ║
    ║ ✓ Tóm tắt nội dung                           ║
    ╚═══════════════════════════════════════════════╝

┌───────────────────────────────────────────────────────────────────┐
│ 🧪 OPTIONAL: TEST API KEY                                        │
└───────────────────────────────────────────────────────────────────┘

  Chạy test nhanh:
  
    python test_gemini.py
  
  Kết quả mong đợi:
  
    ✅ API Key found: AIzaSyB0h_O7rVZTcSqh...PsCgvK18
    ✅ API Test Success!
    🎉 GEMINI API IS READY TO USE!

┌───────────────────────────────────────────────────────────────────┐
│ ❓ NẾU VẪN INACTIVE SAU KHI RESTART                              │
└───────────────────────────────────────────────────────────────────┘

  1. Kiểm tra .env file:
     - Đúng vị trí: Document Intelligence Service\.env
     - Có dòng: GEMINI_API_KEY=...
     - Không có space thừa
  
  2. Kiểm tra environment variable:
     
     $env:GEMINI_API_KEY
     
     Nếu empty → .env không load được
  
  3. Test API key:
     
     python test_gemini.py
  
  4. Check internet connection:
     - API cần kết nối internet
     - Firewall không block

┌───────────────────────────────────────────────────────────────────┐
│ 💡 TẠI SAO PHẢI RESTART?                                         │
└───────────────────────────────────────────────────────────────────┘

  Python load_dotenv() chạy 1 LẦN khi import config
  
  Khi bạn sửa .env:
    ❌ Config cũ đã load vào memory
    ❌ Không tự động reload
    ✅ PHẢI restart Python process
  
  Giống như:
    Sửa code → Phải restart server
    Sửa .env → Phải restart server

╔═══════════════════════════════════════════════════════════════════╗
║               🔴 ACTION NOW: RESTART SERVICE!                     ║
║                                                                   ║
║   1. Ctrl+C trong terminal cũ                                    ║
║   2. Chạy: .\restart_service.bat                                 ║
║   3. Mở: http://127.0.0.1:5003                                   ║
║   4. Check: AI Enhancement = ACTIVE ✅                           ║
╚═══════════════════════════════════════════════════════════════════╝
