<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Speech2Text Assistant</title>
    
    <!-- External Libraries -->
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style_modern.css') }}">
</head>
<body>
    <!-- Sidebar Toggle (Mobile) -->
    <div class="sidebar-toggle" id="sidebarToggle">‚ò∞</div>
    
    <div class="main-wrapper">
        <!-- Sidebar -->
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h3>üìù L·ªãch s·ª≠ phi√™n</h3>
                <button class="new-session-btn" id="newSessionBtn">+ M·ªõi</button>
            </div>
            
            <!-- Storage Info -->
            <div class="storage-display">
                <div class="storage-header">
                    <span class="storage-icon">üíæ</span>
                    <span class="storage-text">B·ªô nh·ªõ</span>
                    <span class="storage-status" id="storageStatus">OK</span>
                </div>
                <div class="storage-progress-container">
                    <div class="storage-progress-bar" id="storageProgressBar" style="width: 0%;"></div>
                </div>
                <div class="storage-footer">
                    <span class="storage-percentage" id="storagePercentage">0%</span>
                    <button class="storage-cleanup-btn" id="cleanupBtn">üóëÔ∏è D·ªçn d·ªçn</button>
                </div>
            </div>
            
            <!-- Session List -->
            <div class="session-list" id="sessionList">
                <!-- Sessions will be dynamically added here -->
            </div>
        </div>
        
        <!-- Main Content -->
        <div class="container">
            <!-- Header -->
            <div class="header">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <div style="text-align: center; flex: 1;">
                        <h1>üéôÔ∏è Speech2Text Assistant</h1>
                        <p>Chuy·ªÉn ƒë·ªïi gi·ªçng n√≥i th√†nh vƒÉn b·∫£n v·ªõi AI - H·ªó tr·ª£ ph√¢n t√°ch ng∆∞·ªùi n√≥i</p>
                    </div>
                    <a href="https://github.com/SkastVnT/AI-Assistant/tree/master/Speech2Text%20Services" 
                       target="_blank" 
                       rel="noopener noreferrer" 
                       class="github-badge">
                        <svg height="24" width="24" viewBox="0 0 16 16" fill="currentColor">
                            <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/>
                        </svg>
                        <span>@SkastVnT</span>
                    </a>
                </div>
            </div>
            
            <!-- Controls -->
            <div class="controls">
                <div class="control-group">
                    <label>
                        Model:
                        <select id="modelSelect">
                            <option value="dual" selected>Dual (Whisper + PhoWhisper) ‚≠ê</option>
                            <option value="whisper">Whisper Large v3</option>
                            <option value="phowhisper">PhoWhisper (Vietnamese)</option>
                        </select>
                    </label>
                    
                    <label>
                        Enhancement:
                        <select id="enhancementSelect">
                            <option value="qwen" selected>Qwen (AI Enhancement)</option>
                            <option value="none">None (Raw Transcript)</option>
                        </select>
                    </label>
                    
                    <label>
                        <input type="checkbox" id="diarizationCheck" checked>
                        üé≠ Ph√¢n t√°ch ng∆∞·ªùi n√≥i
                    </label>
                    
                    <button class="export-btn" id="exportBtn" title="Export results" disabled>
                        üì• Export
                    </button>
                    
                    <button class="dark-mode-toggle" id="darkModeBtn" title="Toggle Dark Mode">üåô</button>
                    
                    <button id="clearResultsBtn" title="Clear current results">üóëÔ∏è X√≥a</button>
                </div>
            </div>
            
            <!-- Results Container -->
            <div class="results-container" id="resultsContainer">
                <div class="welcome-message">
                    <div class="welcome-icon">üéôÔ∏è</div>
                    <h2>Ch√†o m·ª´ng ƒë·∫øn v·ªõi Speech2Text Assistant!</h2>
                    <p>Upload file √¢m thanh ƒë·ªÉ b·∫Øt ƒë·∫ßu chuy·ªÉn ƒë·ªïi gi·ªçng n√≥i th√†nh vƒÉn b·∫£n</p>
                    <div class="feature-list">
                        <div class="feature-item">‚úÖ H·ªó tr·ª£: MP3, WAV, M4A, FLAC, OGG</div>
                        <div class="feature-item">‚úÖ Ph√¢n t√°ch ng∆∞·ªùi n√≥i t·ª± ƒë·ªông</div>
                        <div class="feature-item">‚úÖ AI Enhancement v·ªõi Qwen</div>
                        <div class="feature-item">‚úÖ Timeline transcript chi ti·∫øt</div>
                    </div>
                </div>
            </div>
            
            <!-- Progress Indicator -->
            <div class="progress-section" id="progressSection" style="display: none;">
                <div class="progress-header">
                    <div class="progress-title" id="progressTitle">ƒêang x·ª≠ l√Ω...</div>
                    <div class="progress-percent" id="progressPercent">0%</div>
                </div>
                <div class="progress-bar-container">
                    <div class="progress-bar" id="progressBar" style="width: 0%;"></div>
                </div>
                <div class="progress-message" id="progressMessage">ƒêang kh·ªüi t·∫°o...</div>
                <button class="cancel-btn" id="cancelBtn">‚èπÔ∏è H·ªßy</button>
            </div>
            
            <!-- Upload Area -->
            <div class="upload-container">
                <div class="upload-area" id="uploadArea">
                    <div class="upload-icon">üéµ</div>
                    <div class="upload-text">
                        <strong>K√©o th·∫£ file audio v√†o ƒë√¢y</strong>
                        <span>ho·∫∑c click ƒë·ªÉ ch·ªçn file</span>
                    </div>
                    <div class="upload-formats">MP3, WAV, M4A, FLAC, OGG (Max 500MB)</div>
                    <input type="file" id="audioInput" accept=".mp3,.wav,.m4a,.flac,.ogg" style="display: none;">
                </div>
                
                <!-- Selected File Info -->
                <div class="file-info" id="fileInfo" style="display: none;">
                    <div class="file-name" id="fileName"></div>
                    <div class="file-size" id="fileSize"></div>
                    <button class="remove-file-btn" id="removeFileBtn">‚úñ</button>
                </div>
                
                <!-- Process Button -->
                <button class="process-btn" id="processBtn" disabled>
                    üöÄ B·∫Øt ƒë·∫ßu x·ª≠ l√Ω
                </button>
            </div>
        </div>
    </div>
    
    <!-- Export Modal -->
    <div id="exportModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üì• Export Results</h2>
                <button class="close-modal" onclick="closeExportModal()">&times;</button>
            </div>
            <div class="export-options">
                <button class="export-option-btn" onclick="exportTimeline()">
                    üìÑ Timeline Transcript (.txt)
                </button>
                <button class="export-option-btn" onclick="exportEnhanced()">
                    ‚ú® Enhanced Transcript (.txt)
                </button>
                <button class="export-option-btn" onclick="exportSegments()">
                    üé≠ Speaker Segments (.txt)
                </button>
                <button class="export-option-btn" onclick="exportAll()">
                    üì¶ All Files (.zip)
                </button>
            </div>
        </div>
    </div>
    
    <!-- Load JavaScript -->
    <script src="{{ url_for('static', filename='js/app_modern.js') }}"></script>
</body>
</html>
