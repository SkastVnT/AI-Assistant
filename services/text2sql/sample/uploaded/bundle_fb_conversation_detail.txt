-- FILE: fb_conversation_detail.txt
create table fb_conversation_detail
(
    _id               String,
    conversation_id   Nullable(String),
    shop_id           Nullable(String),
    channel_info      String,
    conversation_type Nullable(UInt8),
    created_at        DateTime64(3, 'UTC'),
    deleted_at        Nullable(DateTime64(3, 'UTC')),
    has_address       Nullable(UInt8),
    has_phone         Nullable(UInt8),
    is_enable_ai_bot  Nullable(UInt8),
    is_read           Nullable(UInt8),
    is_user_message   Nullable(UInt8),
    labels            Array(String),
    last_message      Nullable(String),
    last_message_from Nullable(String),
    last_sender_by    Nullable(String),
    metadata          String,
    phone_numbers     Array(String),
    read_by           Nullable(String),
    source            Nullable(String),
    source_id         Nullable(String),
    state             Nullable(String),
    tag_ids           Array(String),
    total_unread      Nullable(Int64),
    updated_at        DateTime64(3, 'UTC'),
    updated_time      Nullable(Int64),
    user_info         String,
    read_at           Nullable(DateTime64(3, 'UTC')),
    staff_id          Nullable(String)
)
    engine = MergeTree PARTITION BY toYYYYMM(created_at)
        ORDER BY (created_at, _id)
        SETTINGS index_granularity = 8192;
